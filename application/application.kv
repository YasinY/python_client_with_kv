#:import LoginScreen application.screen.impl.login.LoginScreen
#:import ChatHandler application.screen.impl.chat.ChatHandler
#:import Chat application.screen.impl.chat.impl.Chat
#Declares parent properties
#Screenmanager
<Widget>:
    canvas.after:
        Line:
            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
            dash_offset: 5
            dash_length: 3
<ScreenManagement>
    LoginScreen:
    ChatHandler:
    Chat:
#Declares custom parent, sub elements are childs
<LoginScreen>:
    name: "loginScreen"
    id: loginScreen
    AnchorLayout:
        TextInput:
            id: username
            pos: root.center_x - self.width / 2, root.center_y
            size_hint: 0.25, 0.05
        Label: # Seems like there is a bug in kivy that you can't put a label right under AnchorLayout without having size_hints's values above 0 (0.1+)
            font_size: 18
            text: "Username" # Looks buggy because of the upper rectangle mod (to show grids/layouts)
            pos: username.pos[0] - username.width / 4, username.pos[1] + (username.height / 2) - self.height
            size_hint: 0, 0
        Label:
            font_size: 18
            text: "Password"
            pos: password.pos[0] - password.width / 4, password.pos[1] + (password.height / 2) - self.height
            size_hint: 0, 0
        TextInput:
            id: password
            password: True
            size_hint: 0.25, 0.05
            pos: username.pos[0], username.pos[1] - self.height
        Button:
            id: login
            text: "Login"
            pos: 30, 30
            size_hint: password.size_hint_x / 2, 0.05
            pos: password.pos[0], password.pos[1] - self.height
            on_press: root.login(username.text, password.text)
        Button:
            id: register
            text: "Register"
            pos: 30, 30
            size_hint: password.size_hint_x / 2, 0.05
            pos: login.pos[0] + self.width, login.pos[1]
<ChatHandler>
    name: "chatHandler"
    id: chatHandler
    BoxLayout:
        orientation: "vertical" # Top to bottom
        size_hint: (0.2, 1)
        Chat:
            id: chat_1 #unique chat id
        Chat:
            id: chat_2 #unique chat id
        Chat:
            id: chat_3 #unique chat id
        Chat:
            id: chat_4 #unique chat id
    ## APPEND CHATS HERE ##
    ## END OF CHAT APPEND ##

# CHAT DESIGN
<Chat>
    id: None
    BoxLayout:
        orientation: "vertical"
        Label:
            text: "[ref=title]title[/ref]"
            markup: True
            on_ref_press: root.openChat(self.text)
        Label:
            text: "last_message"